<!--components/merchantoverview/merchantoverview.wxml-->
<wxs module="filter">
  var filterTitle = function(activity){
    var str='';
    console.log(2222,activity);
    if(activity.type == 'platnew' || activity.type == 'shopnew') {
      str = '立减'+activity.value+'元'
      return str
    } else {
      for(var i = 0;i<activity.youhui.length;i++) {
        str += "满" + activity.youhui[i].cond_count + "减" + activity.youhui[i].value + "元 "
      }
      return str;
    }
  }
  module.exports.filterTitle = filterTitle;

</wxs>
<view class='merchant-wrapper box-thin-border' catchtap="merchantTap" data-id="{{merchant.shopid}}">
  <view class='top'>
    <image class='image image-bg' src="{{merchant.pic}}" mode="aspectFill"></image>
    <view class='overview'>
      <view class='title-and-distance'>
        <view class='title'>{{merchant.name}}</view>
        <view class='distance' wx:if="{{merchant.distance}}">{{merchant.distance}}</view>
      </view>
      <star-box wx:if="{{merchant.star}}" score="{{merchant.star}}" />
      <view wx:else style="height:6rpx"></view>
      <view class='merchant-act' wx:for="{{merchant.huodong}}" wx:for-item="activity" wx:key="id">
        <text-icon class='act-icon' size="{{actIconSize}}" font-size="{{24}}" color="{{colorObj[activity.type]}}" text="{{textObj[activity.type]}}" />
        <text class='act-text'>{{filter.filterTitle(activity)}}</text>
      </view>
    </view>
  </view>
  <view wx:if="{{merchant.notice}}" class='bottom'>
    <view class='line-separator-h'></view>
    <view class='notice'>
      <text class='iconfont icon-notice'></text>
      <text class='notice-text'>{{merchant.notice}}</text>
    </view>
  </view>
  <!-- <view class='merchant-border box-thin-border'></view> -->
</view>
